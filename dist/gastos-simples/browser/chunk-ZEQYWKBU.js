import{Kd as p,U as m,Z as M}from"./chunk-HGVQTMEK.js";var l=class u{constructor(n){this.storageService=n}getCurrentMonthBalance(){let n=this.getCurrentMonth();return this.getMonthBalance(n)}getMonthBalance(n){let t=this.getMonthTransactions(n),e=this.getMonthIncome(t),s=this.getMonthExpenses(t);return e-s}getCurrentMonthIncome(){let n=this.getCurrentMonth(),t=this.getMonthTransactions(n);return this.getMonthIncome(t)}getCurrentMonthExpenses(){let n=this.getCurrentMonth(),t=this.getMonthTransactions(n);return this.getMonthExpenses(t)}getSalary(){return this.storageService.getSettings().salary}getSalaryDay(){return this.storageService.getSettings().salaryDay}getCreditCardDueDay(){return this.storageService.getSettings().creditCardDueDay}getExpensesByCategory(n){let t=n||this.getCurrentMonth(),e=this.getMonthTransactions(t),s=this.storageService.getSettings(),a=e.filter(r=>r.amount<0),c=this.getMonthExpenses(a),g=new Map;return a.forEach(r=>{let o=Math.abs(r.amount),i=g.get(r.category);i?(i.amount+=o,i.count+=1):g.set(r.category,{amount:o,count:1})}),Array.from(g.entries()).map(([r,o])=>{let i=s.categories.find(h=>h.name===r);return{category:r,amount:o.amount,color:i?.color||"#000000",percentage:c>0?o.amount/c*100:0,transactionCount:o.count}}).sort((r,o)=>o.amount-r.amount)}getMonthlySummary(n){let t=this.getMonthTransactions(n),e=this.getMonthIncome(t),s=this.getMonthExpenses(t);return{month:n,income:e,expenses:s,balance:e-s,transactionCount:t.length}}getLast12Months(){return this.getLast12MonthsList().map(t=>this.getMonthlySummary(t))}getCreditCardExpenses(n){let t=n||this.getCurrentMonth();return this.getMonthTransactions(t).filter(s=>s.isCreditCard&&s.amount<0).reduce((s,a)=>s+Math.abs(a.amount),0)}getCreditCardExpensesByCategory(n){let t=n||this.getCurrentMonth(),e=this.getMonthTransactions(t),s=this.storageService.getSettings(),a=e.filter(r=>r.isCreditCard&&r.amount<0),c=a.reduce((r,o)=>r+Math.abs(o.amount),0),g=new Map;return a.forEach(r=>{let o=Math.abs(r.amount),i=g.get(r.category);i?(i.amount+=o,i.count+=1):g.set(r.category,{amount:o,count:1})}),Array.from(g.entries()).map(([r,o])=>{let i=s.categories.find(h=>h.name===r);return{category:r,amount:o.amount,color:i?.color||"#000000",percentage:c>0?o.amount/c*100:0,transactionCount:o.count}}).sort((r,o)=>o.amount-r.amount)}getSavingsRate(n){let t=n||this.getCurrentMonth(),e=this.getMonthIncome(this.getMonthTransactions(t)),s=this.getMonthExpenses(this.getMonthTransactions(t));return e===0?0:(e-s)/e*100}getAverageDailyExpense(n){let t=n||this.getCurrentMonth(),e=this.getMonthExpenses(this.getMonthTransactions(t)),s=new Date(t+"-01").getDate();return e/s}getLargestExpense(n){let t=n||this.getCurrentMonth(),s=this.getMonthTransactions(t).filter(a=>a.amount<0);return s.length===0?null:s.reduce((a,c)=>Math.abs(c.amount)>Math.abs(a.amount)?c:a)}getCurrentMonth(){return new Date().toISOString().slice(0,7)}getMonthTransactions(n){return this.storageService.getTransactions().filter(e=>e.date.startsWith(n))}getMonthIncome(n){return n.filter(t=>t.amount>0).reduce((t,e)=>t+e.amount,0)}getMonthExpenses(n){return n.filter(t=>t.amount<0).reduce((t,e)=>t+Math.abs(e.amount),0)}getLast12MonthsList(){let n=[],t=new Date;for(let e=0;e<12;e++){let s=new Date(t.getFullYear(),t.getMonth()-e,1);n.push(s.toISOString().slice(0,7))}return n.reverse()}static \u0275fac=function(t){return new(t||u)(M(p))};static \u0275prov=m({token:u,factory:u.\u0275fac,providedIn:"root"})};export{l as a};
